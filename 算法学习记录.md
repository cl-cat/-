# 算法学习记录







## 数学



### 数论



### 组合数学



#### 前置知识



##### 斯特林数（Stirling Number）

> 第二类斯特林数比第一类斯特林数常用的多

- **第二类斯特林数**（斯特林子集数） $\begin{Bmatrix}n\\ k\end{Bmatrix}$ ，也可记做 $S_2(n, k)$ ，表示将 $n$ 个两两不同的元素，划分为 $k$ 个互不区分的非空子集的方案数。

  - <u>递推式</u>： $S_2(n, k) = S_2(n - 1, k - 1) + k \cdot S_2(n - 1, k)$ ，边界： $S_2(n, 0) = [n = 0]$ 。

    > 对于想要新增的第 $n$ 个元素：
    >
    > 如果把这个元素放在**独立的**一个子集里面，那么就是 $S_2(n − 1,k − 1)$ 。
    > 如果把这个元素放在**现有的**一个子集里面，也就是在 $S_2(n − 1 , k)$ 的情况下，找一个子集插入一个元素，因为有 $k$ 个子集所以要乘 $k$ 。

  - <u>通项式</u>： $S_2(n,k) = \frac{1}{k!} \sum_{i = 0}^{k} (-1)^i C_m^i (k - i)^n $ 。

    > 证明略。

  - <u>一些性质</u>：

    1.  $S_2(0, 0) = 1$ 

    2.  $S_2(n, 0) = 0, n>0$ 

    3.  $S_2(n,n) = 1$ 

    4.  $S_2(n, 2) = S_2(n-1,1) + 2 * S_2(n-1,2) = 1 + 2 * S_2(n - 1, 2) = 2^{n - 1} - 1$ 

    5.  $S_2(n, 3) = \frac{1}{2} (3^{n - 1} + 1) - 2^{n - 1}$ 

    6.  $S_2(n, n - 1) = C_n^2$ 

    7.  $S_2(n, n-2) = C_n^3 + 3C_n^4$ 

       > 简单巧妙的证明：我们分成两种情况，把 $n$ 个不同的元素分成 $n−2$ 个集合有两种情况，分别是有一个集合有三个元素和有两个集合有两个元素。对于前者，我们选出三个元素为一个集合，其他的各成一个集合，这种情况的方案数就是 $C_n^3$ 。对于后者，先选出四个元素来，考虑怎么分配。当其中一个元素选定另一个元素形成同一个集合时，这种情况就确定了，所以是 $3C_n^4$ 。加法原理计算和即得证。

    8.  $S_2(n, n - 3) = C_n^4 + 10C_n^5 + 15C_n^6$ 

       > 同理 7.

- **第一类斯特林数**（斯特林轮换数） $\begin{bmatrix}n\\ k\end{bmatrix}$ ，也可记做 $S_1(n, k)$ ，表示将 $n$ 个两两不同的元素，划分为 $k$ 个互不区分的非空轮换的方案数。

  > 一个轮换就是一个首尾相接的环形排列。我们可以写出一个轮换 $[A, B, C, D]$ ，并且我们认为 $[A,B,C,D] = [D,A,B,C] = [C,D,A,B] =[B,C,D,A]$ ，即，两个可以通过旋转而互相得到的轮换是等价的。

  > 更清晰的理解，第一类斯特林数表示把 $n$ 个不同元素构成 $m$ 个圆的排列方案数。
  >

  - <u>递推式</u>： $S_1(n, k) = S_1(n - 1, k - 1) + (n - 1) \cdot S_1(n - 1, k)$ ，边界： $S_1(n, 0) = [n = 0]$ 。

    > 对于想要新增的第 $n$ 个元素：
    >
    > 如果把这个元素放在**独立的**一个圆里面，那么就有 $S_1(n − 1,k − 1)$ 种方案。
    > 如果把这个元素放在**现有的**一个圆里面，也就是在 $S_1(n−1,k)$ 的情况下，这个元素可以放在前 $(n - 1)$ 个元素中任意一个的前面，所以要乘 $(n - 1)$ 。

  - <u>通项公式</u>：第一类斯特林数没有实用的通项公式。
  - <u>一些性质</u>：
    1.  $S_1(0, 0) = 1$ 
    2.  $S_1(n, 0) = 0$ 
    3.  $S_1(n, 1) = (n - 1)!$ 
    4.  $S_1(n, n - 1) = C_n^2$ 
    5.  $S_1(n, 2) = (n - 1)! \sum _{i = 1}^{n - 1} \frac{1}{i}$ 
    6.  $S_1(n, n - 2) = 2C_n^3 + 3C_n^4$ 
    7.  $\sum_{k = 0}^n S_1(n, k) = n!$ 























#### 错位排列

- **定义**：如果定义全排列 $n$ ~ $1$ ，那么一个排列满足任意的 $i$ 都满足 $a[i] \neq i$ ，称之为错位排列。定义集合元素个数为 $n$ 的错位排列个数为 $D_n$ 

- **递推公式**： $D_n = (n - 1)(D_{n - 1} + D_{n - 2})$ ，初始化 $D_{1} = 0 D_2 = 1$ 。

  > 假设 $n \geq 3$ ，考虑 $\{1 2\dots n \}$ 的 $D_n$ 个错位排列
  > 来看看第一个位置的情况：
  > 它可以是除 $1$ 以外的任何数字，那么一共有 $n - 1$ 种情况并且每一种情况所产生的排列数都应该相同，我们设为 $d_n$ 
  > 也就是说 $D_n=(n−1)d_n$ 
  > 现在来看看 $d_n$ ：
  > 因为第 $1$ 个位置可以是除 $1$ 以外的任何数，并且产生排列数相同。
  > 出于方便，我们假设第 $1$ 个位置的数是 $2$ ：
  > 确定了第一个位置之后我们发现只需要讨论第二个位置是不是 $1$ 这是一个特殊的点。
  >
  > 如果第 $2$ 个位置是 $1$ ，那接下来的 $n−2$ 个位置等价于 $n$ 个元素中有两个元素调换了位置。
  > 那我们可以把他们踢出去，他们已经不影响问题了。
  > 而剩下的元素将继续进行错位排列，也就是 $D_{n−2}$ 。
  >
  > 如果第 $2$ 个位置不是 $1$ ，这时候来重新陈述一下问题：
  > 第 $2$ 个位置不能是 $1$ ，第 $3$ 个位置不能是 $3$ ，第 $4$ 个位置不能是 $4$ ，……，第 $n$ 个位置不能是 $n$ 
  > 这个问题是不是似曾相识？
  > 是的，又是一个错排，这个错排只少了一个位置，所以他是 $D_n−1$ 。
  >
  > 得到：$d_n=D_{n−1}+D_{n−2}$ 
  > 联立之前的式子就是 $D_n=(n−1)(D_{n−1}+D_{n−2})$ 



#### 盒子与球

- **问题描述**：想将个 $n$ 球放入 $m$ 个盒子中，有几种放入方法？（将球是否相同，盒子是否相同，是否可以有空盒分为八种情况）

- **具体解决**：

  1. <u>球相同，盒子不同，不可空盒</u>：

     - 挡板法，相当于将 $n$ 个球分成 $m$ 组，相当于在 $n - 1$ 个空隙中插入 $m - 1$ 块板子。
     - 结论： $C_{n - 1}^{m - 1}$ 

  2. <u>球相同，盒子不同，可以空盒</u>：

     - 预先在每个盒子中放入 $1$ 个球，总共放入 $m$ 个球。现在等价于 $(1)$ 的问题。
     - 结论： $C_{n + m - 1}^{m - 1}$ 

  3. <u>球相同， 盒子相同，不可空盒</u>：

     - 动态规划。

     - 假设 $f[n][m]$ 为 $n$ 个球放到 $m$ 个盒子里的方案数。

       如果 $n < m$ ，此时 $m$ 个盒子必然装不满，可得 $f[n][m] = f[n][n]$ 。

       如果 $n \geq m$ ，此时可以选择将盒子放满或者不放满：

       ​	（1）如果没放满，就减掉一个盒子，此时 $f[i][j] = f[i][j - 1]$ 。

       ​	（2）如果放满了，那就在每个盒子里放一个球，此时 $f[i][j] = f[i - j][j]$ 。

       综上，转移方程为： $f[i][j] = f[i][j - 1] + f[i - j][j]$ 。 

       得到转移方程之后考虑边界条件：

       如果没有球或者只有一个盒子，此时方案数为 $1$ ，即 $f[0][j] = f[i][1] = 1$ 。

  4. <u>球相同，盒子相同，可以空盒</u>：

     - 类比问题 $(3)$ 的情况，此时问题的答案为 $f[n - m][m]$ 的值。

  5. <u>球不同，盒子不同，不可空盒</u>：

     - 







































































































